function Circle(a,b,c,d){this.context=a,this.x=b,this.y=c,this.radius=d}function Cursor(a,b,c){this.context=a,this.x=b,this.y=c,this.shape={square:new Square(a),circle:new Circle(a),triangle:new Triangle(a)},this.currentShape=this.shape.square}function ScoreText(a,b,c,d){this.context=a,this.text="+"+b,this.visible=!0,this.triggered=!1,this.x=c,this.y=d}function Square(a,b,c,d){this.context=a,this.x=b,this.y=c,this.size=d||40}function Timer(a,b,c){this.context=a,this.time=c,this.callback=b,this.stopped=!0}function Triangle(a,b,c,d){this.context=a,this.width=d||50,this.x=b,this.y=c}Circle.prototype.draw=function(){this.context.beginPath(),this.context.fillStyle=this.fillStyle||"#fff",this.context.arc(this.x,this.y,this.radius||20,0,2*Math.PI),this.context.fill(),this.context.closePath()},Circle.prototype.getRadius=function(){return this.radius},Circle.prototype.getY=function(){return this.y},Circle.prototype.getX=function(){return this.x},Circle.prototype.setY=function(a){this.y=a},Circle.prototype.setX=function(a){this.x=a},Circle.prototype.setColour=function(a){this.fillStyle=a},Cursor.prototype.draw=function(){this.currentShape.setX(this.x),this.currentShape.setY(this.y),this.currentShape.setColour("#fff"),this.currentShape.draw()},Cursor.prototype.setX=function(a){this.x=a},Cursor.prototype.setY=function(a){this.y=a},Cursor.prototype.getX=function(){return this.x},Cursor.prototype.getY=function(){return this.y},Cursor.prototype.changeShape=function(a){switch(a){case 1:this.currentShape=this.shape.square;break;case 2:this.currentShape=this.shape.circle;break;case 3:this.currentShape=this.shape.triangle}},ScoreText.prototype.display=function(){if(this.context.beginPath(),this.context.font="15pt Calibri",this.context.textAlign="center",this.context.fillStyle="#000",this.context.fillText(this.text,this.x,this.y),this.context.closePath(),!this.triggered){this.triggered=!0;var a=this;setTimeout(function(){a.visible=!1},1e3)}},ScoreText.prototype.setVisible=function(a){this.visible=a},ScoreText.prototype.isVisible=function(){return this.visible},Square.prototype.draw=function(){this.context.beginPath(),this.context.fillStyle=this.fillStyle||"#fff",this.context.fillRect(this.x-this.size/2,this.y-this.size/2,this.size,this.size),this.context.closePath()},Square.prototype.getY=function(){return this.y},Square.prototype.getX=function(){return this.x},Square.prototype.setY=function(a){this.y=a},Square.prototype.setX=function(a){this.x=a},Square.prototype.setColour=function(a){this.fillStyle=a},Timer.prototype.getPercentage=function(){return this.timeStarted?(Date.now()-this.timeStarted)/this.time*100:0},Timer.prototype.setTimer=function(a){this.time=a},Timer.prototype.start=function(){this.stopped=!1,this.y=0,this.timeStarted=Date.now();var a=this;this.id=setTimeout(function(){a.stopped=!0,a.callback()},this.time)},Timer.prototype.stop=function(){this.stopped=!0,clearTimeout(this.id)},Timer.prototype.reset=function(){this.stop(),this.start()},Timer.prototype.draw=function(){this.stopped||(this.y=60+(Date.now()-this.timeStarted)/this.time*450),this.context.beginPath(),this.context.fillStyle="#6AC0F7",this.context.fillRect(0,this.y,1e4,1e4),this.context.stroke(),this.context.closePath()},Triangle.prototype.draw=function(){this.context.beginPath(),this.context.fillStyle=this.fillStyle||"#fff",this.context.moveTo(this.x+5-this.width/2,this.y+this.width/2-5),this.context.lineTo(this.x-5+this.width/2,this.y+this.width/2-5),this.context.lineTo(this.x,this.y-this.width/2+5),this.context.fill(),this.context.closePath()},Triangle.prototype.getY=function(){return this.y},Triangle.prototype.getX=function(){return this.x},Triangle.prototype.setY=function(a){this.y=a},Triangle.prototype.setX=function(a){this.x=a},Triangle.prototype.setColour=function(a){this.fillStyle=a};var game=function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m=500,n=800,o=5e3,p=60,q="#F08811",r=function(){for(var a=0;a<e.length;a++){var g=e[a],h=30;if(c.getX()<=g.getX()+h&&c.getX()>=g.getX()-h&&c.getY()<=g.getY()+h&&c.getY()>=g.getY()-h&&c.currentShape.constructor==g.constructor){e.splice(a,1),0===e.length&&i.stop();var j=100-Math.floor(i.getPercentage());d+=j;var k=new ScoreText(b,j,c.getX(),c.getY());f.push(k)}}},s=function(){for(var a=0;a<f.length;a++)f[a].visible||f.splice(a,1)},t=function(){r(),s()},u=function(){for(var a=0;a<e.length;a++){var b=e[a];b.draw()}},v=function(){for(var a=0;a<f.length;a++)f[a].visible&&f[a].display()},w=function(){u(),c.draw(),C(),v(),l&&(b.beginPath(),b.font="15pt Calibri",b.textAlign="center",b.fillStyle="#222",b.fillText("Use the number keys to change shape",a.width/2,400),b.closePath())},x=function(a,b,c){for(var d=0;d<e.length;d++){var f=e[d];if(a<=f.getX()+c&&a>=f.getX()-c&&b<=f.getY()+c&&b>=f.getY()-c)return!1}return!0},y=function(){var a,c,d=Math.floor(3*Math.random())+1,f=100,g=0;do c=100+Math.random()*(n-200),a=100+Math.random()*(m-200),g++;while(!x(c,a,f)&&50>g);switch(d){case 1:var h=new Circle(b,c,a,30);h.setColour(q),e.push(h);break;case 2:var i=new Square(b,c,a,60);i.setColour(q),e.push(i);break;case 3:var j=new Triangle(b,c,a,80);j.setColour(q),e.push(j)}},z=function(){b.beginPath(),b.clearRect(0,0,a.width,a.height),b.closePath()},A=function(){z(),b.beginPath(),b.fillStyle="#2980b9",b.fillRect(0,0,a.width,a.height),b.stroke(),b.closePath()},B=function(){k=!1,clearInterval(j),A(),b.beginPath();var a=n/2,c=m/2;b.beginPath(),b.font="52pt Calibri",b.textAlign="center",b.fillStyle="#fff",b.fillText("Score: "+d,a,c),b.font="16pt Calibri",b.fillText("Click to play again",a,c+40),b.closePath()},C=function(){b.beginPath(),b.fillStyle="#666",b.fillRect(0,0,a.width,50),b.stroke(),b.closePath();var e=new Square(b,50,25,40);c.currentShape instanceof Square&&(e.fillStyle="#ccc"),e.draw(),b.beginPath(),b.font="15pt Calibri",b.textAlign="center",b.fillStyle="#000",b.fillText("1",50,32),b.closePath();var f=new Circle(b,100,25);c.currentShape instanceof Circle&&f.setColour("#ccc"),f.draw(),b.beginPath(),b.font="15pt Calibri",b.textAlign="center",b.fillStyle="#000",b.fillText("2",100,32),b.closePath();var g=new Triangle(b,150,25);c.currentShape instanceof Triangle&&g.setColour("#ccc"),g.draw(),b.beginPath(),b.font="15pt Calibri",b.textAlign="center",b.fillStyle="#000",b.fillText("3",150,32),b.fillStyle="#fff",b.fillText(d,a.width-100,35),b.closePath()},D=function(){i.stop(),l&&(l=!1),h++,g+=.5;for(var a=0;g>a;a++)y();i.start()},E=function(){var c=a.width/2,d=250,f=new Circle(b,c,d,p/2);f.setColour(q),e.push(f)},F=function(){c=new Cursor(b),d=0,h=1,e=[],f=[],g=1,k=!0,l=!0,i=new Timer(b,function(){B()},o)},G=function(){F(),E(),j=setInterval(function(){0===e.length&&D(),A(),i.draw(),w(),t()},40)},H=function(b){c.setX(b.pageX-a.offsetLeft),c.setY(b.pageY-a.offsetTop)},I=function(){k||(G(),k=!0)},J=function(a){switch(a.keyCode){case 49:case 56:c.changeShape(1);break;case 50:case 57:c.changeShape(2);break;case 51:case 48:c.changeShape(3)}},K=function(){a.addEventListener("click",I),window.addEventListener("mousemove",H),window.addEventListener("touchstart",H),window.addEventListener("keydown",J)},L=function(c){a=c,a.height=m,a.width=n,b=c.getContext("2d"),K(),G()};return{init:L}}();document.addEventListener("DOMContentLoaded",function(){var a=document.getElementById("demo");a&&game.init(a);var b=document.getElementById("contact-form");if(b){var c,d=document.getElementById("chars-left"),e=b.getElementsByTagName("textarea")[0],f=function(){var a=e.value.length,b=e.getAttribute("data-max");c=b-a,d.innerHTML=c,d.className=0>c?"text-error":.2*b>c?"text-warning":"text-success"};f(),e.addEventListener("input",f),b.addEventListener("submit",function(a){0>c&&a.preventDefault()})}});